{% extends "base.html" %}

{% block title %}Expenses{% endblock %}

{% block footer %}

<script>
  
  var text_max = 100;
  $('#count_message').html('0 / ' + text_max);

  $('#text').keyup(function () {
    var text_length = $('#text').val().length;
    var text_remaining = text_max - text_length;

    $('#count_message').html(text_length + ' / ' + text_max);
  });

  $(document).ready(function () { /**
     * Validate the form
     */
     $("#cancel").click(function() {
        document.getElementById("inputAmount").required = false;
        document.getElementById("inputDate").required = false;
     })

    $("#formExpenses").validate({
      rules: {
        income_comment: {
          maxlength: 100
        }
      },

      highlight: function (element, errorClass, validClass) {
        $(element).addClass("is-invalid").removeClass("is-valid");
      },
      unhighlight: function (element, errorClass, validClass) {
        $(element).addClass("is-valid").removeClass("is-invalid");
      }

    });
  });
</script>

{% endblock %}

{% block body %}

<body class="canva">

    <header>
        <nav>
            <div class="navbar navbar-expand-lg navbar-dark">
                <div class="container-fluid">

                    <p class="offcanvas-title fw-bold"><i class="bi bi-bank"></i> Budget app</p>

                    <a class="navbar-toggler" href="#offcanvasExample" data-bs-toggle="offcanvas"
                        aria-controls="offcanvasExample">
                        <span class="navbar-toggler-icon"></span>
                    </a>

                    <div class="offcanvas offcanvas-start text-bg-dark" tabindex="-1" id="offcanvasExample"
                        aria-labelledby="offcanvasExample">
                        <div class="offcanvas-header">
                            <p class="offcanvas-title"><i class="bi bi-bank"></i> Budget app</p>
                        </div>
                        <div class="offcanvas-body">
                            <ul class="navbar-nav nav-pills nav-tabs m-auto mb-2 mb-lg-0">
                                <li class="nav-item">
                                    <a class="nav-link px-3" href="/home/index"><i class="bi bi-house"></i> Home</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link px-3" href="/income/new"><i class="bi bi-plus-square"></i> Add
                                        income</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link active px-3" href="/expense/new"><i
                                            class="bi bi-dash-square"></i> Add expense</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link px-3" href="/balance/new"><i class="bi bi-clipboard-data"></i>
                                        Balance</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link px-3" href="./settings.html"><i class="bi bi-gear-fill"></i>
                                        Settings</a>
                                </li>
                            </ul>
                            <form class="d-flex">
                                <button class="btn btn-success px-3" type="submit" formaction="/logout">Logout</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

    </header>
    <main class="container py-5">
        <form class="bd-example text-white" method="post" id="formExpenses">
            <h3>Add Expense</h3>
            <hr>
            {% if expense.errors is not empty %}
            <h5 class="text-start">Errors:</h5>
            <ul class="text-start">
                {% for error in expense.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
            {% endif %}
            <div class="mb-3">
                <label for="inputAmount" class="form-label">Amount</label>
                <input type="number" step="0.01" class="form-control" id="inputAmount" name="amount" placeholder="0,00" value="{{ expense.amount }}" required>
            </div>
            <div class="mb-3">
                <label for="inputDate" class="form-label">Date</label>
                <input type="date" class="form-control" id="inputDate" name="date_of_expense" value="{{ expense.date_of_expense }}" required>
            </div>

            <label for="inputPaymentMethod" class="form-label mb-3">Payment method</label>

            <select class="form-select" id="inputPaymentMethod" name="payment_method_assigned_to_user_id" value="{{ expense.payment_method_assigned_to_user_id }}" required>
                <option>Cash</option>
                <option>Debit Card</option>
                <option>Credit Card</option>
            </select>

            <label for="inputCategory" class="form-label my-3">Category</label>

            <select class="form-select" id="inputCategory" name="expense_category_assigned_to_user_id" value="{{ expense.expense_category_assigned_to_user_id }}" required>
                <option >Transport</option>
                <option >Books</option>
                <option >Food</option>
                <option >Apartments</option>
                <option >Telecommunication</option>
                <option >Health</option>
                <option >Clothes</option>
                <option >Hygiene</option>
                <option >Kids</option>
                <option >Recreation</option>
                <option >Trip</option>
                <option >Savings</option>
                <option >For Retirement</option>
                <option >Debt Repayment</option>
                <option >Gift</option>
                <option >Another</option>
            </select>

            <div class="my-3">
                <label for="text" class="form-label">Comment (optional)</label>
                <input type="text" class="form-control" id="text" maxlength="100" placeholder="eg. sale of bicycles" name="expense_comment">
                <span class="pull-right label label-default" id="count_message"></span>
            </div>

            <div class="mb-3 text-center">
                <button class="btn btn-danger col-md-4" type="submit" id="cancel" formaction="/home/index">Cancel</button>
                <button class="btn btn-success col-md-4 mx-3" type="submit" formaction="/expense/add">Add</button>
            </div>
        </form>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
        crossorigin="anonymous"></script>

</body>






{% endblock %}